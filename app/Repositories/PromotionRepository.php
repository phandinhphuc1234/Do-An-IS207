<?php

namespace App\Repositories;

use App\Models;
use App\Models\Promotion;
use App\Repositories\IPromotionRepository;
use Illuminate\Support\Facades\DB;

class PromotionRepository implements IPromotionRepository
{
    public function calculateDiscount(Promotion $promotion, float $amount)
    {
        $max_discount = $promotion->max_discount_amount ?? PHP_FLOAT_MAX;
        if ($promotion->discount_type === 'percentage') {
            return min($max_discount, $amount * ($promotion->discount_value / 100));
        } elseif ($promotion->discount_type === 'fixed_amount') {
            return min($max_discount, $promotion->discount_value);
        }
        return 0;
    }
}
